<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="Some Fortran program which I wrote.">
    
    <meta name="author" content="Chris MacMackin" >
    <link rel="icon" href="../favicon.png">

    <title>implicit_diffusion &ndash; diffort</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">diffort </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
                
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
				
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
								
				
            <li><a href="../lists/programs.html">Programs</a></li>
				
          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>implicit_diffusion 
    <small>Program</small>
    
    </h1>
	 
<div class="row">
<div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
    <li><i class="fa fa-code"></i><a href="../src/implicit.f90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li><a href='../sourcefile/implicit.f90.html'>implicit.f90</a></li>
  
     <li class="active">implicit_diffusion</li>
  </ol>
</div>
</div>
</div>
    
  </div>
  
  <div class="row">
    <div class="col-lg-3">
    
<div id="sidebar">
  
  
  
  <div class="panel panel-primary">
    <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars">Variables</a></h3></div>
    <div id="vars" class="panel-collapse collapse">
      <div class="list-group">
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-x_source%7E2">x_source</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-s_source%7E2">s_source</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-x%7E8">x</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-phi%7E3">Phi</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-d%7E3">D</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-x_total%7E3">x_total</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-delta_x%7E5">delta_x</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-delta_x_min%7E4">delta_x_min</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-n_x%7E5">n_x</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-t_final%7E3">t_final</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-delta_t%7E2">delta_t</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-t%7E3">t</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-n_t%7E2">n_t</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-i%7E9">i</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-j%7E8">j</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-n%7E4">n</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-k">K</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-m%7E2">M</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-mkm1">Mkm1</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-a%7E2">A</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-ckm1%7E2">Ckm1</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-l">l</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-s%7E2">S</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-b%7E2">b</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-mkm1ckm1">Mkm1Ckm1</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-c%7E2">C</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-delta_xj%7E2">delta_xj</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-delta_xjm1%7E2">delta_xjm1</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-k_r%7E3">k_r</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-debug%7E2">debug</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-t_save%7E3">t_save</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-t_step%7E3">t_step</a>
        
        <a class="list-group-item" href="../program/implicit_diffusion.html#variable-n_file%7E2">n_file</a>
        
      </div>
    </div>
  </div>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <hr>
  
  <div class="panel panel-default">
    <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allprogs">All Programs</a></h3></div>
    <div id="allprogs" class="panel-collapse collapse">
        <div class="list-group">
          
          <a class="list-group-item" href="../program/explicit_diffusion.html">explicit_diffusion</a>
          
          <a class="list-group-item" href="../program/implicit_diffusion.html">implicit_diffusion</a>
          
        </div>
    </div>
  </div>
  
</div>

    </div>
    
    <div class="col-lg-9" id='text'>
    
  
    <ul class="list-inline">
      <li><h4>Uses:</h4></li>
      
      <li><a href='../module/input_output.html'>input_output</a></li>
      
      <li><a href='../module/linear_algebra.html'>linear_algebra</a></li>
      
      <li><a href='../module/mesh.html'>mesh</a></li>
      
    </ul>
  

    
    
    <p>Read in the inital distribution from a SRIM file
 convert the depth coordinates in x from angstroms to cm
 convert the ion deposition source from atoms/cm^3 / atoms/cm^2 to just
 atoms/cm^3 by multiplying by the fluence
 Create a mesh
 Lets actually create a stiffness matrix, dissipation matrix, source term,
 history term, and forcing term
 The source term never changes, so we can calculate this only once
 The dissipation matrix and history dissipation matrix never change, so we can
 calculate this only once
 now we can go through the time steps
 initialize all of the matices and vectors to zero
 construct the first term of the forcing element
 Loop through the mesh elements and construct the terms
 find the mesh spacing
 now we can create the stiffness matrix
 Then, solve the matrix and print the solution</p>
    
    <br>

    
    <section>
    <h2>Variables</h2>
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-x_source%7E2"></span>real(kind=8),</td>
  
  
  <td>allocatable, dimension(:)</td><td>::</td>
  <td><strong>x_source</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-s_source%7E2"></span>real(kind=8),</td>
  
  
  <td>allocatable, dimension(:)</td><td>::</td>
  <td><strong>s_source</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-x%7E8"></span>real(kind=8),</td>
  
  
  <td>allocatable, dimension(:)</td><td>::</td>
  <td><strong>x</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-phi%7E3"></span>real(kind=8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>Phi</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-d%7E3"></span>real(kind=8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>D</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-x_total%7E3"></span>real(kind=8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>x_total</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-delta_x%7E5"></span>real(kind=8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>delta_x</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-delta_x_min%7E4"></span>real(kind=8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>delta_x_min</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-n_x%7E5"></span>integer(kind=4)</td>
  
  
  <td></td><td>::</td>
  <td><strong>n_x</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t_final%7E3"></span>real(kind=8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>t_final</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-delta_t%7E2"></span>real(kind=8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>delta_t</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t%7E3"></span>real(kind=8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>t</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-n_t%7E2"></span>integer(kind=4)</td>
  
  
  <td></td><td>::</td>
  <td><strong>n_t</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-i%7E9"></span>integer(kind=4)</td>
  
  
  <td></td><td>::</td>
  <td><strong>i</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-j%7E8"></span>integer(kind=4)</td>
  
  
  <td></td><td>::</td>
  <td><strong>j</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-n%7E4"></span>integer(kind=4)</td>
  
  
  <td></td><td>::</td>
  <td><strong>n</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-k"></span>real(kind=8),</td>
  
  
  <td>allocatable, dimension(:,:)</td><td>::</td>
  <td><strong>K</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-m%7E2"></span>real(kind=8),</td>
  
  
  <td>allocatable, dimension(:,:)</td><td>::</td>
  <td><strong>M</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mkm1"></span>real(kind=8),</td>
  
  
  <td>allocatable, dimension(:,:)</td><td>::</td>
  <td><strong>Mkm1</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-a%7E2"></span>real(kind=8),</td>
  
  
  <td>allocatable, dimension(:,:)</td><td>::</td>
  <td><strong>A</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ckm1%7E2"></span>real(kind=8),</td>
  
  
  <td>allocatable, dimension(:)</td><td>::</td>
  <td><strong>Ckm1</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-l"></span>real(kind=8),</td>
  
  
  <td>allocatable, dimension(:)</td><td>::</td>
  <td><strong>l</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-s%7E2"></span>real(kind=8),</td>
  
  
  <td>allocatable, dimension(:)</td><td>::</td>
  <td><strong>S</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-b%7E2"></span>real(kind=8),</td>
  
  
  <td>allocatable, dimension(:)</td><td>::</td>
  <td><strong>b</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mkm1ckm1"></span>real(kind=8),</td>
  
  
  <td>allocatable, dimension(:)</td><td>::</td>
  <td><strong>Mkm1Ckm1</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-c%7E2"></span>real(kind=8),</td>
  
  
  <td>allocatable, dimension(:)</td><td>::</td>
  <td><strong>C</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-delta_xj%7E2"></span>real(kind=8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>delta_xj</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-delta_xjm1%7E2"></span>real(kind=8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>delta_xjm1</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-k_r%7E3"></span>real(kind=8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>k_r</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-debug%7E2"></span>logical</td>
  
  
  <td></td><td>::</td>
  <td><strong>debug</strong></td><td> =</td><td>.FALSE.</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t_save%7E3"></span>real(kind=8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>t_save</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t_step%7E3"></span>real(kind=8)</td>
  
  
  <td></td><td>::</td>
  <td><strong>t_step</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-n_file%7E2"></span>integer(kind=4)</td>
  
  
  <td></td><td>::</td>
  <td><strong>n_file</strong></td><td></td><td></td><td></td>
  
</tr>

</tbody>
</table>

    </section>
    <br>
    
    
    
    
    
    
    

    
    
    


    
    
    
    
    </div>
  </div>

    <hr>
    <footer>
        <div class="row">
        <div class="col-md-4">&copy; 2016 <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/80x15.png" /></a></div>
	<div class="col-md-4"><span class="text-center"> diffort was developed by Alex Hagen</span></div>
        <div class="col-md-4"><span class="pull-right">Documentation generated by <a href="https://github.com/cmacmackin/ford">FORD</a></span></div>
        </div>
        <br>
    </footer>
    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>